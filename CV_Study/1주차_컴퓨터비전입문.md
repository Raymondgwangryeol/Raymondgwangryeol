# 1주차 컴퓨터 비전 입문

강의: 세종대학교 최유경 교수님 '딥러닝 시스템'       
</br>     
## 1주차 목차
1. 컴퓨터 비전
2. 컴퓨터 비전 응용 분야
3. 컴퓨터 비전 파이프라인 전체 처리 과정
4. 이미지 입력
5. 이미지 전처리
6. 특징 추출
7. 분류 학습 알고리즘     
</br></br>   

## 1-1. 컴퓨터 비전
### ■ 컴퓨터 비전의 개념   
  **컴퓨터 비전** 은 **시각적 인지(Visual Perception)을 다루는 분야** 로, 특히, 영상(images)과 비디오(videos)를 이용해 세계를 인식하고 이해하는 분야를 말한다.     
  </br>
  시각적 인지란?    
  시각적 **입력** + 주변 사물, 상태의 **이해** 또는 **패턴 관찰**    
  
### ■ 비전 시스템(Vision Systems)
  정의: 이미지 처리 기법(전통적인 정의) + 이미지를 통해 어떤 일이 일어났는지 이해하는 것   
  인공지능의 비전 시스템 연구는 사람의 시각 시스템에 착안함.    
  </br>
  **사람의 시각 시스템:** 사물 → 눈 → 뇌 → 인식    
  **인공지능 시각 시스템:** 데이터 → 감지 장치(카메라) → 해석 장치 → 예측 결과   
  </br>
  <img src="https://static.javatpoint.com/tutorial/computer-vision/images/computer-vision-techniques.png"></img>
  </br>
  
  **해석 장치**는 사물 인식, 패턴 학습을 담당. 즉, 뇌의 역할을 함. 일반적으로 **컴퓨터 비전 알고리즘** 이 해당 역할을 수행.   
  뇌의 동작에 영감을 받아 개발된 알고리즘이 **인공 신경망(ANN, Artificla Neural Network)** 임   
  인공 신경망은 뉴런의 학습 능력을 모방, 뉴런을 서로 연결한 구조임. 입력된 신호가 임계점을 넘어 일정 이상 활성화 되면 자신과 연결된 모든 뉴런에 신호 전달.   
  각각 단순한 구조의 뉴런 수백만 개가 서로 연결되고 층을 구성하면 학습 능력을 보이게 됨.   
  </br>
  여러 층을 가진 신경망을 만드는 기법 = **딥러닝(Deep Learning)**    
  딥러닝은 뉴런으로 구성된 층에 데이터를 통과시커 데이터를 여러번 반환하는 방법으로, 데이터의 표현(representation)을 학습. 
  인공 신경망(ANN), 합성곱 신경망(CNN), 순환 신경망(RNN), 트랜스포머(Transfomer) 등이 있음.
  
  </br>
  
  비전 시스템은 특정 태스크(task)를 수행하도록 설계 됐고, 시스템의 목적에 맞는 **감지 장치**를 선택하는 것이 중요함(단일 감지 장치 사용, 또는 다양한 감지 장치를 조합해서 사용).   
  </br>
  - 감지 장치 사용 예시(**자율주행자동차**)   
    - 라이다(Lidar): 고해상도 3D 지도(HD Map)제작 및 위치 인식
    - 카메라: 교통 표지판 및 도로 표시 인식
    - 레이다(Radar): 사물의 거리, 현재 속도 인식   
  </br></br>
  
 ## 1-2. 컴퓨터 비전 응용 분야
  ### ■ 이미지 분류
   이미지가 주어졌을 때 미리 정리한 유한한 수의 라벨(lable) 중 해당 이미지에 대한 라벨(각 라벨에 대한 신뢰도를 표시하는 분류)을 예측하는 일   
  ### ■ 사물 인식/물체 검출
  - 분류(Classification): 단일 물체 인식
  - 분류 및 위치 인식(Classification & Localization): 단일 물체 인식 + 위치 파악
  - 물체 검출(Object Detection): 다중 물체 인식 + 위치 파악</br>   
   <img src="https://drek4537l1klr.cloudfront.net/elgendy/HighResolutionFigures/figure_1-7.png" width="400px" height="300px"></img></br>
  ### ■ 화풍 모방(Neural Style Transfer)
  원본 이미지에 특정 스타일을 입혀 새로운 형태의 이미지를 생성</br>   
  <img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F2105064558F6BCD51B"></img></br>
  ### ■ 새로운 이미지 창조(Deepfake)
  적대적 생성 신경망(GAN)은 진짜같은 사물, 사람, 장소 이미지를 만들어낼 수 있음   
  기존에 없던 새로운 이미지지만 원래 있던 것 같은 이미지를 생성   
  ### ■ 안면 인식
   사람의 이미지를 정확하게 식별하거나 태그를 지정하는 기술. 아주 많은 수의 라벨이 정의된 이미지 분류라고 할 수 있음.   
   - 안면 대조(Face Verification): 신원 일치를 확인하는 일대일 매칭(이 사람이 정말 동일 인물이 맞나)
   - 안면 식별(Face Identification): 이미지를 데이터베이스와 비교해서 일치하는 후보를 식별하는 일대다 매칭(많은 data 중에 특정 인물과 일치하는 이미지가 있는지)
  ### ■ 이미지 검색
  찾고자 하는 영상과 유사한 영상을 찾는 기술(예: 네이버 렌즈)   
  </br></br>

## 1-3. 컴퓨터 비전 파이프라인 전체 과정
  일련의 서로 구분되는 단계를 거쳐 이미지를 분석하고 처리하는 일련의 과정을 컴퓨터 비전 파이프라이닝이라고 함.   
  **컴퓨터 비전 파이프라이닝 단계** 
  데이터 입력 -> 전처리 -> 특징 추출 -> 모델 학습   
  </br>
  <img src="https://drek4537l1klr.cloudfront.net/elgendy/HighResolutionFigures/figure_1-14.png"></img></br>
  
  ### ■ 이미지 분류 성능 향상 기법
  - 1단계 반복: 학습 이미지를 더 많이 입력
  - 2단계 반복: **노이즈** 를 더 많이 **제거** 
  - 3단계 개선: **더 나은 특징 추출**
  - 4단계 개선: 분류 알고리즘의 하이퍼파라미터 튜닝 혹은 분류 알고리즘 변경   
 </br>

  **추가) 하이퍼파라미터 vs 파라미터**   
    - 하이퍼파라미터: 모델링 시 사용자가 직접 세팅해주는 값   
    - 파라미터: 모델 또는 데이터에 의해 결정되는 값   
  </br></br>

## 1-4. 이미지 입력
  이미지는 이미지 구성 기본 요소인 픽셀(Pixel)로 이루어져 있음. 픽셀은 각 좌표의 빛의 강도를 나타냄.   
  이미지를 2차원으로 정의 가능(x,y)    
  F(x,y) = 좌표(x,y)에 위치한 빛의 강도   
  컬러 이미지의 F(x,y) = [**red(x,y), green(x,y), blue(x,y)**](채널이 3개 존재)   
  이미지를 함수로 나타내면 이미지를 함수로 생각할 수 있고, 수학적 연산을 통해 새로운 이미지로 변환 가능함.   
  </br></br>

## 1-5. 이미지 전처리
  컴퓨터상에서 이미지는 픽셀값이 담긴 2차원 행렬로 나타남. 이 데이터 뭉텅이에서 특징을 추출하기 전 계산 복잡도를 낮추기 위해 필요없는 정보를 제거하는 등의 처리를 하는데, 이 단계가 이미지 전처리 단계임.    
  프로젝트 상황에 따라 필요한 전처리 기법을 선택하는 방법을 익혀야 함.    
  </br>
  ### ■ 회색조 이미지로 변환
    이미지의 대상을 인식하는 게 목적일 경우 컬러 이미지를 회색조 이미지로 변환, 계산 복잡도를 낮출 수 있음.   
    회색조 이미지 변환이 적절하지 않은 경우: 붉은 발진 진단 시스템, 자율주행자동차 차선 감지 시스템 등   
  ### ■ 이미지 표준화
    모델에 따라 데이터 셋 이미지들의 크기 통일   
  ### ■ 데이터 강화
    데이터 셋에 포함된 기존 이미지에 조금씩 변형하여 이를 새로운 데이터로 추가.(배율 조정, 회전 등)
    추가한 데이터로 학습한 모델은 더 다양한 형태와 모양을 가진 대상도 인식 가능함.
    </br>
    <img src="https://drek4537l1klr.cloudfront.net/elgendy/HighResolutionFigures/figure_1-21.png"></img></br>
  </br></br>
## 1-6. 특징 추출
  컴퓨터 비전에서의 특징: **특정 대상에게만 해당** 하는 측정 가능 데이터(예: 자전거에는 인장이 있다)   
  특징 개수가 적을수록, 특징의 변별력이 좋을 수록 좋은 모델.   
  좋은 특징은 **대상과 다른 대상을 쉽게 구분짓게 해주는 속성**을 의미.
  유용한 특징의 조건:
    - 다른 것과 구별될 것
    - 추적과 비교가 쉬울 것
    - 배율, 밝기 ,각도가 달라도 일관적일 것
    - 노이즈가 많은 이미지 또는 대상의 일주만 찍힌 이미지에서도 관찰 가능 할 것    



    


  
   
   
   
  
  
    
  
  
  
  
 


